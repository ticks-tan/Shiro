function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./langs-A0TS5btv.js","./index-D-KyWnh9.js","./index-cPkV6bS0.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{r as t,j as n,_ as x}from"./index-D-KyWnh9.js";import{t as R,i as C}from"./request-DcgPSjoy.js";import{c as T,a as S,M as N}from"./StyledButton-DJLIYB63.js";import{a as I,g as A}from"./viewport-BLAU_psI.js";import{s as M}from"./spring-BiPrtYZ-.js";import{m as O}from"./motion-minimal-DZtZgbm6.js";import{u as P}from"./use-event-callback-B3Y8bRlu.js";import{s as $}from"./dom-XXNktKeO.js";const z=({children:o,className:r,duration:i=.6,spring:a=!1})=>{const s=t.useRef(null),[u,m]=t.useState("auto");return t.useEffect(()=>{if(s.current){const h=new ResizeObserver(d=>{const p=d[0].contentRect.height;m(p)});return h.observe(s.current),()=>{h.disconnect()}}},[]),n.jsx(O.div,{className:T("overflow-hidden",r),style:{height:u},initial:!1,animate:{height:u},transition:a?M:{duration:i},children:n.jsx("div",{ref:s,children:o})})},b=0,B=({ref:o,size:r="base",element:i,selector:a}={})=>{const s=t.useRef(null),[u,m]=t.useState(!1),[h,d]=t.useState(!1),[p,g]=t.useState(!1),f=I(e=>e.h),l=t.useCallback(()=>{let e=s.current||o?.current||i;if(e)return a&&(e=e.querySelector(a)),e},[o,a,i]),c=P(()=>{const e=l();if(!e)return;if(e.scrollHeight<=e.clientHeight+2){g(!1),m(!1),d(!1);return}g(!0);const y=e.scrollTop+e.clientHeight>=e.scrollHeight-b,_=e.scrollTop<=b;m(y),d(_)});t.useEffect(()=>{const e=l();if(e)return e.addEventListener("scroll",c),()=>{e.removeEventListener("scroll",c)}},[c,l,i]),t.useEffect(()=>{c()},[c,f,i]);const v={base:"",lg:"-lg"}[r];return[s,p?S(u&&"mask-t",h&&"mask-b",!u&&!h&&"mask-both")+v:""]},w={"code-card":"_code-card_1c04c_1","scroll-container":"_scroll-container_1c04c_80"},D=o=>{const r=o.match(/filename="([^"]+)"/);return r?r[1]:null},L=t.forwardRef((o,r)=>{const{lang:i,content:a,attrs:s}=o,u=t.useCallback(()=>{navigator.clipboard.writeText(a),R.success("已复制到剪贴板")},[a]),[m,h]=t.useState(null);t.useImperativeHandle(r,()=>m);const[d,p]=t.useState(!0),[g,f]=t.useState(!1);t.useEffect(()=>{const e=m;if(!e)return;const _=A().h/2;if(e.scrollHeight>=_){f(!0);const H=e.querySelector(".highlighted");if(H){const k=parseInt(getComputedStyle(H).height||"0",10),E=e.querySelector("pre > code"),j=Array.from(E.children).indexOf(H);e.scrollTop=k*j-30}}else f(!1)},[a,m]);const l=t.useMemo(()=>D(s||""),[s]),[,c]=B({element:m,size:"lg"}),v=!!l;return n.jsxs("div",{className:S(w["code-card"],"group"),onCopy:$,children:[!!l&&n.jsxs("div",{className:"z-10 flex w-full items-center justify-between rounded-t-xl bg-accent/20 px-5 py-2 text-sm",children:[n.jsx("span",{className:"shrink-0 grow truncate",children:l}),n.jsx("span",{className:"pointer-events-none shrink-0 grow-0","aria-hidden":!0,children:i?.toUpperCase()})]}),!l&&!!i&&n.jsx("div",{"aria-hidden":!0,className:"pointer-events-none absolute bottom-3 right-3 z-10 text-sm opacity-60",children:i.toUpperCase()}),n.jsxs("div",{className:"bg-accent/5 py-4",children:[n.jsx(N,{onClick:u,className:S("absolute right-2 top-2 z-[1] flex text-xs center","rounded-md border border-accent/5 bg-accent/80 p-1.5 text-white backdrop-blur duration-200","opacity-0 group-hover:opacity-100",l&&"!top-12"),children:n.jsx("i",{className:"icon-[mingcute--copy-2-fill] size-4"})}),n.jsxs(z,{spring:!0,className:"relative",children:[n.jsx("div",{ref:h,className:T("relative max-h-[50vh] w-full overflow-auto",d?g?c:"":"!max-h-full",w["scroll-container"]),style:{"--sr-margin":v?"1rem":`${(i?.length||0)*14+4}px`},dangerouslySetInnerHTML:t.useMemo(()=>o.renderedHTML?{__html:o.renderedHTML}:void 0,[o.renderedHTML]),children:o.children}),g&&d&&n.jsx("div",{className:`absolute inset-x-0 bottom-0 flex justify-center py-2 duration-200 ${["mask-both-lg","mask-b-lg"].includes(c)?"":"pointer-events-none opacity-0"}`,children:n.jsxs("button",{onClick:()=>p(!1),"aria-hidden":!0,className:"flex items-center justify-center text-xs",children:[n.jsx("i",{className:"icon-[mingcute--arrow-to-down-line]"}),n.jsx("span",{className:"ml-2",children:"展开"})]})})]})]})]})});L.displayName="ShikiHighLighterWrapper";const V=(async()=>{if(C)return;const[{getHighlighterCore:o},r,{codeHighlighter:i}]=await Promise.all([x(()=>import("./core-Cy3QYQK5.js"),[],import.meta.url),x(()=>import("./wasm-CsTmP73Z.js"),[],import.meta.url).then(s=>s.default),x(()=>import("./core-Bni-KVaB.js"),[],import.meta.url)]),a=await o({themes:[x(()=>import("./github-light-CRlnGVMD.js"),[],import.meta.url),x(()=>import("./github-dark-CzPA46E-.js"),[],import.meta.url)],langs:[],loadWasm:r});return{codeHighlighter:a,fn:s=>i(a,s)}})(),Y=o=>{const{lang:r,content:i,attrs:a}=o,s=t.use(V);t.use(t.useMemo(async()=>{async function g(c,v){const e=s?.codeHighlighter;e&&(e.getLoadedLanguages().includes(c)||await e.loadLanguage(await v()))}const{bundledLanguages:f}=await x(()=>import("./langs-A0TS5btv.js"),__vite__mapDeps([0,1,2]),import.meta.url);if(!r)return;const l=f[r];if(l)return g(r||"",l)},[s?.codeHighlighter,r]));const u=t.useMemo(()=>s?.fn?.({attrs:a||"",code:i,lang:r?r.toLowerCase():""}),[a,s,r,i]),[m,h]=t.useState(u),[d,p]=t.useState(null);return t.useEffect(()=>{h(u),requestAnimationFrame(()=>{if(!u||!d)return;const g=d.querySelectorAll(".line"),f=Math.max(...Array.from(g).map(c=>c.scrollWidth));g.forEach(c=>{c.style.width=`${f}px`});const l=d.querySelector("pre");l&&h(l.outerHTML)})},[d,u]),n.jsx(L,{...o,renderedHTML:m,ref:p})};export{z as A,L as S,Y as a};
